# 基本設計（ドラフト）

## 1. 全体構成図（イメージ）

```
[ X API ]──┐
           │
        [n8n]──→[Notion API]──→[Notion DB]
           │         │
           │         └─→[AI API（OpenAI等）]
           │                   │
           └─→[Slack/LINE]←───┘
                │
           [Laravel管理UI/API]
```

---

## 2. 機能ブロックごとの設計

### A. n8nワークフロー
- X投稿取得フロー（定期取得→Notion保存）
- AI分析・チャット応答フロー（Slack/LINE→AI→回答）
- 管理・監視フロー（エラー通知・ログ）

### B. Laravel（管理UI/API）
- 設定管理（Xユーザ名、Notion DB ID、APIキー等）
- 履歴閲覧（X投稿一覧・AI応答履歴）
- n8n/Python連携（Webhook/API）

### C. Python（補助的）
- n8nで難しいAI前処理・データ整形
- 高度なデータ抽出・変換

---

## 3. データ設計（Notion DBスキーマ案）

| カラム名         | 型         | 説明                     |
|------------------|------------|--------------------------|
| 投稿日付         | Date       | X投稿の日時              |
| 投稿内容         | Text       | 本文                     |
| リプライ情報     | Text/JSON  | リプライ先・内容         |
| RT情報           | Number/Text| RT数・元投稿情報         |
| 画像             | URL/Files  | メディアURL              |
| 返信情報         | Text/JSON  | 返信先・内容             |
| X投稿ID          | Text       | 一意なID（重複防止用）   |
| 投稿URL          | URL        | X上の投稿URL             |

---

## 4. 運用・セキュリティ設計
- APIキー・認証情報は.env等で厳重管理
- n8n/Laravel/PythonはVPS上でDocker等により分離運用
- データの外部公開は禁止（個人利用のみ）
- エラー・例外時は管理者に通知

---

## 5. 拡張性・今後の展望
- 複数ユーザ対応、通知機能、外部サービス連携も容易に追加可能な設計
- Dify等のAIワークフロー拡張も視野

---

> 本ドキュメントは随時アップデートします。 